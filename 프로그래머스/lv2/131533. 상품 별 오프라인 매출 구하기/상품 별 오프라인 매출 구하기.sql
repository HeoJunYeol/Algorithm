SELECT P.PRODUCT_CODE, SUM(P.PRICE * O.SALES_AMOUNT) AS SALES
FROM PRODUCT AS P
JOIN OFFLINE_SALE AS O
USING(PRODUCT_ID)
GROUP BY PRODUCT_CODE
ORDER BY SALES DESC, P.PRODUCT_CODE;